import numpy as np
import matplotlib.pyplot as plt
from get_npd_p1d import LyA_P1D	
import itertools

p22 = LyA_P1D(2.2,1)
p24 = LyA_P1D(2.4,1)
p26 = LyA_P1D(2.6,1)
p28 = LyA_P1D(2.8,1)
p30 = LyA_P1D(3.0,1)
p32 = LyA_P1D(3.2,1)
p34 = LyA_P1D(3.4,1)
p36 = LyA_P1D(3.6,1)
p38 = LyA_P1D(3.8,1)
p40 = LyA_P1D(4.0,1)
p42 = LyA_P1D(4.2,1)
p44 = LyA_P1D(4.4,1)

colors1 = itertools.cycle(["purple","red","blue","black","limegreen","orange","darkturquoise","plum","yellow","lightskyblue","silver","forestgreen"])
colors2 = itertools.cycle(["purple","red","blue","black","limegreen","orange","darkturquoise","plum","yellow","lightskyblue","silver","forestgreen"])

fig = plt.figure(figsize=(10,6))
ax = fig.add_subplot(1, 1, 1)
ax.set_xlabel(r'$k\,\left(\rm km/s\right)^{-1}$', fontsize=16)
ax.set_ylabel(r'$kP(k)/\pi$', fontsize=16)
plt.errorbar(p22.k,p22.k/np.pi*(p22.Pk),yerr=p22.k/np.pi*p22.Pk_stat,fmt='o',color=next(colors1))
plt.errorbar(p24.k,p24.k/np.pi*(p24.Pk),yerr=p24.k/np.pi*p24.Pk_stat,fmt='o',color=next(colors1))
plt.errorbar(p26.k,p26.k/np.pi*(p26.Pk),yerr=p26.k/np.pi*p26.Pk_stat,fmt='o',color=next(colors1))
plt.errorbar(p28.k,p28.k/np.pi*(p28.Pk),yerr=p28.k/np.pi*p28.Pk_stat,fmt='o',color=next(colors1))
plt.errorbar(p30.k,p30.k/np.pi*(p30.Pk),yerr=p30.k/np.pi*p30.Pk_stat,fmt='o',color=next(colors1))
plt.errorbar(p32.k,p32.k/np.pi*(p32.Pk),yerr=p32.k/np.pi*p32.Pk_stat,fmt='o',color=next(colors1))
plt.errorbar(p34.k,p34.k/np.pi*(p34.Pk),yerr=p34.k/np.pi*p34.Pk_stat,fmt='o',color=next(colors1))
plt.errorbar(p36.k,p36.k/np.pi*(p36.Pk),yerr=p36.k/np.pi*p36.Pk_stat,fmt='o',color=next(colors1))
plt.errorbar(p38.k,p38.k/np.pi*(p38.Pk),yerr=p38.k/np.pi*p38.Pk_stat,fmt='o',color=next(colors1))
plt.errorbar(p40.k,p40.k/np.pi*(p40.Pk),yerr=p40.k/np.pi*p40.Pk_stat,fmt='o',color=next(colors1))
plt.errorbar(p42.k,p42.k/np.pi*(p42.Pk),yerr=p42.k/np.pi*p42.Pk_stat,fmt='o',color=next(colors1))
plt.errorbar(p44.k,p44.k/np.pi*(p44.Pk),yerr=p44.k/np.pi*p44.Pk_stat,fmt='o',color=next(colors1))

plt.plot(p22.k,p22.k/np.pi*(p22.Pk_emp()),color=next(colors2))
plt.plot(p24.k,p24.k/np.pi*(p24.Pk_emp()),color=next(colors2))
plt.plot(p26.k,p26.k/np.pi*(p26.Pk_emp()),color=next(colors2))
plt.plot(p28.k,p28.k/np.pi*(p28.Pk_emp()),color=next(colors2))
plt.plot(p30.k,p30.k/np.pi*(p30.Pk_emp()),color=next(colors2))
plt.plot(p32.k,p32.k/np.pi*(p32.Pk_emp()),color=next(colors2))
plt.plot(p34.k,p34.k/np.pi*(p34.Pk_emp()),color=next(colors2))
plt.plot(p36.k,p36.k/np.pi*(p36.Pk_emp()),color=next(colors2))
plt.plot(p38.k,p38.k/np.pi*(p38.Pk_emp()),color=next(colors2))
plt.plot(p40.k,p40.k/np.pi*(p40.Pk_emp()),color=next(colors2))
plt.plot(p42.k,p42.k/np.pi*(p42.Pk_emp()),color=next(colors2))
plt.plot(p44.k,p44.k/np.pi*(p44.Pk_emp()),color=next(colors2))
# plt.errorbar(p22.k,p22.k/np.pi*(p22.Pk-p22.Pk_metal),yerr=p22.k/np.pi*p22.Pk_stat,fmt='o',color=next(colors))
# plt.errorbar(p24.k,p24.k/np.pi*(p24.Pk-p24.Pk_metal),yerr=p24.k/np.pi*p24.Pk_stat,fmt='o',color=next(colors))
# plt.errorbar(p26.k,p26.k/np.pi*(p26.Pk-p26.Pk_metal),yerr=p26.k/np.pi*p26.Pk_stat,fmt='o',color=next(colors))
# plt.errorbar(p28.k,p28.k/np.pi*(p28.Pk-p28.Pk_metal),yerr=p28.k/np.pi*p28.Pk_stat,fmt='o',color=next(colors))
# plt.errorbar(p30.k,p30.k/np.pi*(p30.Pk-p30.Pk_metal),yerr=p30.k/np.pi*p30.Pk_stat,fmt='o',color=next(colors))
# plt.errorbar(p32.k,p32.k/np.pi*(p32.Pk-p32.Pk_metal),yerr=p32.k/np.pi*p32.Pk_stat,fmt='o',color=next(colors))
# plt.errorbar(p34.k,p34.k/np.pi*(p34.Pk-p34.Pk_metal),yerr=p34.k/np.pi*p34.Pk_stat,fmt='o',color=next(colors))
# plt.errorbar(p36.k,p36.k/np.pi*(p36.Pk-p36.Pk_metal),yerr=p36.k/np.pi*p36.Pk_stat,fmt='o',color=next(colors))
# plt.errorbar(p38.k,p38.k/np.pi*(p38.Pk-p38.Pk_metal),yerr=p38.k/np.pi*p38.Pk_stat,fmt='o',color=next(colors))
# plt.errorbar(p40.k,p40.k/np.pi*(p40.Pk-p40.Pk_metal),yerr=p40.k/np.pi*p40.Pk_stat,fmt='o',color=next(colors))
# plt.errorbar(p42.k,p42.k/np.pi*(p42.Pk-p42.Pk_metal),yerr=p42.k/np.pi*p42.Pk_stat,fmt='o',color=next(colors))
# plt.errorbar(p44.k,p44.k/np.pi*(p44.Pk-p44.Pk_metal),yerr=p44.k/np.pi*p44.Pk_stat,fmt='o',color=next(colors))
plt.yscale('log')
plt.xlim(0.000, 0.021)
plt.ylim(0.007,1)
#plt.xticks(np.arange(0.000, 0.022,0.002),np.arange(0.00, 0.022,0.002),fontsize=11)
plt.tick_params(length=10,width=1.2,which='major')
plt.tick_params(length=5,width=.9,which='minor')
plt.title("LyA P1D Likelihood (NPD2013)")
plt.savefig("Figures/LyA_P1D_likelihood_allz_simple.pdf")
